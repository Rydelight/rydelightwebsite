{"data":"J3VzZSBjbGllbnQnOwoKaW1wb3J0ICogYXMgUmVhY3QgZnJvbSAncmVhY3QnOwppbXBvcnQgdXNlRW1ibGFDYXJvdXNlbCwgewogIHR5cGUgVXNlRW1ibGFDYXJvdXNlbFR5cGUsCn0gZnJvbSAnZW1ibGEtY2Fyb3VzZWwtcmVhY3QnOwppbXBvcnQgeyBBcnJvd0xlZnQsIEFycm93UmlnaHQgfSBmcm9tICdsdWNpZGUtcmVhY3QnOwoKaW1wb3J0IHsgY24gfSBmcm9tICdAL2xpYi91dGlscyc7CmltcG9ydCB7IEJ1dHRvbiB9IGZyb20gJ0AvY29tcG9uZW50cy91aS9idXR0b24nOwoKdHlwZSBDYXJvdXNlbEFwaSA9IFVzZUVtYmxhQ2Fyb3VzZWxUeXBlWzFdOwp0eXBlIFVzZUNhcm91c2VsUGFyYW1ldGVycyA9IFBhcmFtZXRlcnM8dHlwZW9mIHVzZUVtYmxhQ2Fyb3VzZWw+Owp0eXBlIENhcm91c2VsT3B0aW9ucyA9IFVzZUNhcm91c2VsUGFyYW1ldGVyc1swXTsKdHlwZSBDYXJvdXNlbFBsdWdpbiA9IFVzZUNhcm91c2VsUGFyYW1ldGVyc1sxXTsKCnR5cGUgQ2Fyb3VzZWxQcm9wcyA9IHsKICBvcHRzPzogQ2Fyb3VzZWxPcHRpb25zOwogIHBsdWdpbnM/OiBDYXJvdXNlbFBsdWdpbjsKICBvcmllbnRhdGlvbj86ICdob3Jpem9udGFsJyB8ICd2ZXJ0aWNhbCc7CiAgc2V0QXBpPzogKGFwaTogQ2Fyb3VzZWxBcGkpID0+IHZvaWQ7Cn07Cgp0eXBlIENhcm91c2VsQ29udGV4dFByb3BzID0gewogIGNhcm91c2VsUmVmOiBSZXR1cm5UeXBlPHR5cGVvZiB1c2VFbWJsYUNhcm91c2VsPlswXTsKICBhcGk6IFJldHVyblR5cGU8dHlwZW9mIHVzZUVtYmxhQ2Fyb3VzZWw+WzFdOwogIHNjcm9sbFByZXY6ICgpID0+IHZvaWQ7CiAgc2Nyb2xsTmV4dDogKCkgPT4gdm9pZDsKICBjYW5TY3JvbGxQcmV2OiBib29sZWFuOwogIGNhblNjcm9sbE5leHQ6IGJvb2xlYW47Cn0gJiBDYXJvdXNlbFByb3BzOwoKY29uc3QgQ2Fyb3VzZWxDb250ZXh0ID0gUmVhY3QuY3JlYXRlQ29udGV4dDxDYXJvdXNlbENvbnRleHRQcm9wcyB8IG51bGw+KG51bGwpOwoKZnVuY3Rpb24gdXNlQ2Fyb3VzZWwoKSB7CiAgY29uc3QgY29udGV4dCA9IFJlYWN0LnVzZUNvbnRleHQoQ2Fyb3VzZWxDb250ZXh0KTsKCiAgaWYgKCFjb250ZXh0KSB7CiAgICB0aHJvdyBuZXcgRXJyb3IoJ3VzZUNhcm91c2VsIG11c3QgYmUgdXNlZCB3aXRoaW4gYSA8Q2Fyb3VzZWwgLz4nKTsKICB9CgogIHJldHVybiBjb250ZXh0Owp9Cgpjb25zdCBDYXJvdXNlbCA9IFJlYWN0LmZvcndhcmRSZWY8CiAgSFRNTERpdkVsZW1lbnQsCiAgUmVhY3QuSFRNTEF0dHJpYnV0ZXM8SFRNTERpdkVsZW1lbnQ+ICYgQ2Fyb3VzZWxQcm9wcwo+KAogICgKICAgIHsKICAgICAgb3JpZW50YXRpb24gPSAnaG9yaXpvbnRhbCcsCiAgICAgIG9wdHMsCiAgICAgIHNldEFwaSwKICAgICAgcGx1Z2lucywKICAgICAgY2xhc3NOYW1lLAogICAgICBjaGlsZHJlbiwKICAgICAgLi4ucHJvcHMKICAgIH0sCiAgICByZWYKICApID0+IHsKICAgIGNvbnN0IFtjYXJvdXNlbFJlZiwgYXBpXSA9IHVzZUVtYmxhQ2Fyb3VzZWwoCiAgICAgIHsKICAgICAgICAuLi5vcHRzLAogICAgICAgIGF4aXM6IG9yaWVudGF0aW9uID09PSAnaG9yaXpvbnRhbCcgPyAneCcgOiAneScsCiAgICAgIH0sCiAgICAgIHBsdWdpbnMKICAgICk7CiAgICBjb25zdCBbY2FuU2Nyb2xsUHJldiwgc2V0Q2FuU2Nyb2xsUHJldl0gPSBSZWFjdC51c2VTdGF0ZShmYWxzZSk7CiAgICBjb25zdCBbY2FuU2Nyb2xsTmV4dCwgc2V0Q2FuU2Nyb2xsTmV4dF0gPSBSZWFjdC51c2VTdGF0ZShmYWxzZSk7CgogICAgY29uc3Qgb25TZWxlY3QgPSBSZWFjdC51c2VDYWxsYmFjaygoYXBpOiBDYXJvdXNlbEFwaSkgPT4gewogICAgICBpZiAoIWFwaSkgewogICAgICAgIHJldHVybjsKICAgICAgfQoKICAgICAgc2V0Q2FuU2Nyb2xsUHJldihhcGkuY2FuU2Nyb2xsUHJldigpKTsKICAgICAgc2V0Q2FuU2Nyb2xsTmV4dChhcGkuY2FuU2Nyb2xsTmV4dCgpKTsKICAgIH0sIFtdKTsKCiAgICBjb25zdCBzY3JvbGxQcmV2ID0gUmVhY3QudXNlQ2FsbGJhY2soKCkgPT4gewogICAgICBhcGk/LnNjcm9sbFByZXYoKTsKICAgIH0sIFthcGldKTsKCiAgICBjb25zdCBzY3JvbGxOZXh0ID0gUmVhY3QudXNlQ2FsbGJhY2soKCkgPT4gewogICAgICBhcGk/LnNjcm9sbE5leHQoKTsKICAgIH0sIFthcGldKTsKCiAgICBjb25zdCBoYW5kbGVLZXlEb3duID0gUmVhY3QudXNlQ2FsbGJhY2soCiAgICAgIChldmVudDogUmVhY3QuS2V5Ym9hcmRFdmVudDxIVE1MRGl2RWxlbWVudD4pID0+IHsKICAgICAgICBpZiAoZXZlbnQua2V5ID09PSAnQXJyb3dMZWZ0JykgewogICAgICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTsKICAgICAgICAgIHNjcm9sbFByZXYoKTsKICAgICAgICB9IGVsc2UgaWYgKGV2ZW50LmtleSA9PT0gJ0Fycm93UmlnaHQnKSB7CiAgICAgICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpOwogICAgICAgICAgc2Nyb2xsTmV4dCgpOwogICAgICAgIH0KICAgICAgfSwKICAgICAgW3Njcm9sbFByZXYsIHNjcm9sbE5leHRdCiAgICApOwoKICAgIFJlYWN0LnVzZUVmZmVjdCgoKSA9PiB7CiAgICAgIGlmICghYXBpIHx8ICFzZXRBcGkpIHsKICAgICAgICByZXR1cm47CiAgICAgIH0KCiAgICAgIHNldEFwaShhcGkpOwogICAgfSwgW2FwaSwgc2V0QXBpXSk7CgogICAgUmVhY3QudXNlRWZmZWN0KCgpID0+IHsKICAgICAgaWYgKCFhcGkpIHsKICAgICAgICByZXR1cm47CiAgICAgIH0KCiAgICAgIG9uU2VsZWN0KGFwaSk7CiAgICAgIGFwaS5vbigncmVJbml0Jywgb25TZWxlY3QpOwogICAgICBhcGkub24oJ3NlbGVjdCcsIG9uU2VsZWN0KTsKCiAgICAgIHJldHVybiAoKSA9PiB7CiAgICAgICAgYXBpPy5vZmYoJ3NlbGVjdCcsIG9uU2VsZWN0KTsKICAgICAgfTsKICAgIH0sIFthcGksIG9uU2VsZWN0XSk7CgogICAgcmV0dXJuICgKICAgICAgPENhcm91c2VsQ29udGV4dC5Qcm92aWRlcgogICAgICAgIHZhbHVlPXt7CiAgICAgICAgICBjYXJvdXNlbFJlZiwKICAgICAgICAgIGFwaTogYXBpLAogICAgICAgICAgb3B0cywKICAgICAgICAgIG9yaWVudGF0aW9uOgogICAgICAgICAgICBvcmllbnRhdGlvbiB8fCAob3B0cz8uYXhpcyA9PT0gJ3knID8gJ3ZlcnRpY2FsJyA6ICdob3Jpem9udGFsJyksCiAgICAgICAgICBzY3JvbGxQcmV2LAogICAgICAgICAgc2Nyb2xsTmV4dCwKICAgICAgICAgIGNhblNjcm9sbFByZXYsCiAgICAgICAgICBjYW5TY3JvbGxOZXh0LAogICAgICAgIH19CiAgICAgID4KICAgICAgICA8ZGl2CiAgICAgICAgICByZWY9e3JlZn0KICAgICAgICAgIG9uS2V5RG93bkNhcHR1cmU9e2hhbmRsZUtleURvd259CiAgICAgICAgICBjbGFzc05hbWU9e2NuKCdyZWxhdGl2ZScsIGNsYXNzTmFtZSl9CiAgICAgICAgICByb2xlPSJyZWdpb24iCiAgICAgICAgICBhcmlhLXJvbGVkZXNjcmlwdGlvbj0iY2Fyb3VzZWwiCiAgICAgICAgICB7Li4ucHJvcHN9CiAgICAgICAgPgogICAgICAgICAge2NoaWxkcmVufQogICAgICAgIDwvZGl2PgogICAgICA8L0Nhcm91c2VsQ29udGV4dC5Qcm92aWRlcj4KICAgICk7CiAgfQopOwpDYXJvdXNlbC5kaXNwbGF5TmFtZSA9ICdDYXJvdXNlbCc7Cgpjb25zdCBDYXJvdXNlbENvbnRlbnQgPSBSZWFjdC5mb3J3YXJkUmVmPAogIEhUTUxEaXZFbGVtZW50LAogIFJlYWN0LkhUTUxBdHRyaWJ1dGVzPEhUTUxEaXZFbGVtZW50Pgo+KCh7IGNsYXNzTmFtZSwgLi4ucHJvcHMgfSwgcmVmKSA9PiB7CiAgY29uc3QgeyBjYXJvdXNlbFJlZiwgb3JpZW50YXRpb24gfSA9IHVzZUNhcm91c2VsKCk7CgogIHJldHVybiAoCiAgICA8ZGl2IHJlZj17Y2Fyb3VzZWxSZWZ9IGNsYXNzTmFtZT0ib3ZlcmZsb3ctaGlkZGVuIj4KICAgICAgPGRpdgogICAgICAgIHJlZj17cmVmfQogICAgICAgIGNsYXNzTmFtZT17Y24oCiAgICAgICAgICAnZmxleCcsCiAgICAgICAgICBvcmllbnRhdGlvbiA9PT0gJ2hvcml6b250YWwnID8gJy1tbC00JyA6ICctbXQtNCBmbGV4LWNvbCcsCiAgICAgICAgICBjbGFzc05hbWUKICAgICAgICApfQogICAgICAgIHsuLi5wcm9wc30KICAgICAgLz4KICAgIDwvZGl2PgogICk7Cn0pOwpDYXJvdXNlbENvbnRlbnQuZGlzcGxheU5hbWUgPSAnQ2Fyb3VzZWxDb250ZW50JzsKCmNvbnN0IENhcm91c2VsSXRlbSA9IFJlYWN0LmZvcndhcmRSZWY8CiAgSFRNTERpdkVsZW1lbnQsCiAgUmVhY3QuSFRNTEF0dHJpYnV0ZXM8SFRNTERpdkVsZW1lbnQ+Cj4oKHsgY2xhc3NOYW1lLCAuLi5wcm9wcyB9LCByZWYpID0+IHsKICBjb25zdCB7IG9yaWVudGF0aW9uIH0gPSB1c2VDYXJvdXNlbCgpOwoKICByZXR1cm4gKAogICAgPGRpdgogICAgICByZWY9e3JlZn0KICAgICAgcm9sZT0iZ3JvdXAiCiAgICAgIGFyaWEtcm9sZWRlc2NyaXB0aW9uPSJzbGlkZSIKICAgICAgY2xhc3NOYW1lPXtjbigKICAgICAgICAnbWluLXctMCBzaHJpbmstMCBncm93LTAgYmFzaXMtZnVsbCcsCiAgICAgICAgb3JpZW50YXRpb24gPT09ICdob3Jpem9udGFsJyA/ICdwbC00JyA6ICdwdC00JywKICAgICAgICBjbGFzc05hbWUKICAgICAgKX0KICAgICAgey4uLnByb3BzfQogICAgLz4KICApOwp9KTsKQ2Fyb3VzZWxJdGVtLmRpc3BsYXlOYW1lID0gJ0Nhcm91c2VsSXRlbSc7Cgpjb25zdCBDYXJvdXNlbFByZXZpb3VzID0gUmVhY3QuZm9yd2FyZFJlZjwKICBIVE1MQnV0dG9uRWxlbWVudCwKICBSZWFjdC5Db21wb25lbnRQcm9wczx0eXBlb2YgQnV0dG9uPgo+KCh7IGNsYXNzTmFtZSwgdmFyaWFudCA9ICdvdXRsaW5lJywgc2l6ZSA9ICdpY29uJywgLi4ucHJvcHMgfSwgcmVmKSA9PiB7CiAgY29uc3QgeyBvcmllbnRhdGlvbiwgc2Nyb2xsUHJldiwgY2FuU2Nyb2xsUHJldiB9ID0gdXNlQ2Fyb3VzZWwoKTsKCiAgcmV0dXJuICgKICAgIDxCdXR0b24KICAgICAgcmVmPXtyZWZ9CiAgICAgIHZhcmlhbnQ9e3ZhcmlhbnR9CiAgICAgIHNpemU9e3NpemV9CiAgICAgIGNsYXNzTmFtZT17Y24oCiAgICAgICAgJ2Fic29sdXRlICBoLTggdy04IHJvdW5kZWQtZnVsbCcsCiAgICAgICAgb3JpZW50YXRpb24gPT09ICdob3Jpem9udGFsJwogICAgICAgICAgPyAnLWxlZnQtMTIgdG9wLTEvMiAtdHJhbnNsYXRlLXktMS8yJwogICAgICAgICAgOiAnLXRvcC0xMiBsZWZ0LTEvMiAtdHJhbnNsYXRlLXgtMS8yIHJvdGF0ZS05MCcsCiAgICAgICAgY2xhc3NOYW1lCiAgICAgICl9CiAgICAgIGRpc2FibGVkPXshY2FuU2Nyb2xsUHJldn0KICAgICAgb25DbGljaz17c2Nyb2xsUHJldn0KICAgICAgey4uLnByb3BzfQogICAgPgogICAgICA8QXJyb3dMZWZ0IGNsYXNzTmFtZT0iaC00IHctNCIgLz4KICAgICAgPHNwYW4gY2xhc3NOYW1lPSJzci1vbmx5Ij5QcmV2aW91cyBzbGlkZTwvc3Bhbj4KICAgIDwvQnV0dG9uPgogICk7Cn0pOwpDYXJvdXNlbFByZXZpb3VzLmRpc3BsYXlOYW1lID0gJ0Nhcm91c2VsUHJldmlvdXMnOwoKY29uc3QgQ2Fyb3VzZWxOZXh0ID0gUmVhY3QuZm9yd2FyZFJlZjwKICBIVE1MQnV0dG9uRWxlbWVudCwKICBSZWFjdC5Db21wb25lbnRQcm9wczx0eXBlb2YgQnV0dG9uPgo+KCh7IGNsYXNzTmFtZSwgdmFyaWFudCA9ICdvdXRsaW5lJywgc2l6ZSA9ICdpY29uJywgLi4ucHJvcHMgfSwgcmVmKSA9PiB7CiAgY29uc3QgeyBvcmllbnRhdGlvbiwgc2Nyb2xsTmV4dCwgY2FuU2Nyb2xsTmV4dCB9ID0gdXNlQ2Fyb3VzZWwoKTsKCiAgcmV0dXJuICgKICAgIDxCdXR0b24KICAgICAgcmVmPXtyZWZ9CiAgICAgIHZhcmlhbnQ9e3ZhcmlhbnR9CiAgICAgIHNpemU9e3NpemV9CiAgICAgIGNsYXNzTmFtZT17Y24oCiAgICAgICAgJ2Fic29sdXRlIGgtOCB3LTggcm91bmRlZC1mdWxsJywKICAgICAgICBvcmllbnRhdGlvbiA9PT0gJ2hvcml6b250YWwnCiAgICAgICAgICA/ICctcmlnaHQtMTIgdG9wLTEvMiAtdHJhbnNsYXRlLXktMS8yJwogICAgICAgICAgOiAnLWJvdHRvbS0xMiBsZWZ0LTEvMiAtdHJhbnNsYXRlLXgtMS8yIHJvdGF0ZS05MCcsCiAgICAgICAgY2xhc3NOYW1lCiAgICAgICl9CiAgICAgIGRpc2FibGVkPXshY2FuU2Nyb2xsTmV4dH0KICAgICAgb25DbGljaz17c2Nyb2xsTmV4dH0KICAgICAgey4uLnByb3BzfQogICAgPgogICAgICA8QXJyb3dSaWdodCBjbGFzc05hbWU9ImgtNCB3LTQiIC8+CiAgICAgIDxzcGFuIGNsYXNzTmFtZT0ic3Itb25seSI+TmV4dCBzbGlkZTwvc3Bhbj4KICAgIDwvQnV0dG9uPgogICk7Cn0pOwpDYXJvdXNlbE5leHQuZGlzcGxheU5hbWUgPSAnQ2Fyb3VzZWxOZXh0JzsKCmV4cG9ydCB7CiAgdHlwZSBDYXJvdXNlbEFwaSwKICBDYXJvdXNlbCwKICBDYXJvdXNlbENvbnRlbnQsCiAgQ2Fyb3VzZWxJdGVtLAogIENhcm91c2VsUHJldmlvdXMsCiAgQ2Fyb3VzZWxOZXh0LAp9Owo="}